{
    "id": "https://mastra.ai/docs/workflows-vnext/suspend-and-resume",
    "title": "Suspend & Resume Workflows (vNext) | Human-in-the-Loop | Mastra Docs",
    "url": "https://mastra.ai/docs/workflows-vnext/suspend-and-resume",
    "author": "",
    "text": "\n Complex workflows often need to pause execution while waiting for external input or resources. \n Mastraâ€™s suspend and resume features let you pause workflow execution at any step, persist the workflow snapshot to storage, and resume execution from the saved snapshot when ready.\nThis entire process is automatically managed by Mastra. No config needed, or manual step required from the user. \n Storing the workflow snapshot to storage (LibSQL by default) means that the workflow state is permanently preserved across sessions, deployments, and server restarts. This persistence is crucial for workflows that might remain suspended for minutes, hours, or even days while waiting for external input or resources. \n When to Use Suspend/Resume \n Common scenarios for suspending workflows include: \n \n Waiting for human approval or input \n Pausing until external API resources become available \n Collecting additional data needed for later steps \n Rate limiting or throttling expensive operations \n Handling event-driven processes with external triggers \n \n How to suspend a step \n const humanInputStep = createStep ({ \n id: \" human-input \", \n inputSchema: z. object ({ \n suggestions: z. array (z. string ()), \n vacationDescription: z. string (), \n }), \n resumeSchema: z. object ({ \n selection: z. string (), \n }), \n suspendSchema: z. object ({}), \n outputSchema: z. object ({ \n selection: z. string (). describe ( \" The selection of the user \"), \n vacationDescription: z. string (), \n }), \n execute: async ({ inputData, resumeData, suspend }) =&gt; { \n if (! resumeData?.selection) { \n await suspend ({}); \n return { \n selection: \"\", \n vacationDescription: inputData?.vacationDescription, \n }; \n } \n return { \n selection: resumeData.selection, \n vacationDescription: inputData?.vacationDescription, \n }; \n }, \n}); \n How to resume step execution \n Identifying suspended state \n When running a workflow, its state can be one of the following: \n \n running - The workflow is currently running \n suspended - The workflow is suspended \n success - The workflow has completed \n failed - The workflow has failed \n \n When the state is suspended, you can identify any and all steps that have been suspended by looking at the suspended property of the workflow. \n const run = counterWorkflow. createRun (); \n const result = await run. start ({ inputData: { startValue: 0 } }); \n \n if (result.status === \" suspended \") { \n const resumedResults = await run. resume ({ \n step: result.suspended[ 0], \n resumeData: { newValue: 0 }, \n }); \n} \n In this case, the logic resumes whatever is the first step reported as suspended. \n The suspended property is of type string[][], where every array is a path to a step that has been suspended, the first element being the step id on the main workflow. If that step is a workflow itself, the second element is the step id on the nested workflow that was suspended, unless it is a workflow itself, in which case the third element is the step id on the nested workflow that was suspended, and so on. \n Resume \n // After getting user input \n const result = await workflowRun. resume ({ \n step: userInputStep, // or 'myStepId' as a string \n resumeData: { \n userSelection: \" User's choice \", \n }, \n}); \n To resume a suspended nested workflow: \n const result = await workflowRun. resume ({ \n step: [nestedWorkflow, userInputStep], // or ['nestedWorkflowId', 'myStepId'] as a string array \n resumeData: { \n userSelection: \" User's choice \", \n }, \n});",
    "image": "https://mastra.ai/api/og/docs?title=Suspend%20&%20Resume%20Workflows%20(vNext)%20|%20Human-in-the-Loop%20|%20Mastra%20Docs&description=Suspend%20and%20resume%20in%20Mastra%20vNext%20workflows%20allows%20you%20to%20pause%20execution%20while%20waiting%20for%20external%20input%20or%20resources.",
    "favicon": "https://mastra.ai/favicon.ico",
    "extras": {
        "links": [
            "https://mastra.ai/en/docs/workflows-vnext/suspend-and-resume",
            "https://mastra.ai/",
            "https://mastra.ai/docs",
            "https://mastra.ai/examples"
        ]
    }
}